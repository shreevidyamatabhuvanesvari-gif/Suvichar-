<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>सुविचार</title>

<style>
html,body{
  margin:0;height:100%;
  background:linear-gradient(#0f2027,#203a43,#2c5364);
  font-family:"Noto Sans Devanagari",system-ui;
  color:#fff;overflow:hidden
}
.container{
  height:100%;display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center
}
#playBtn{
  padding:14px 30px;
  font-size:18px;border-radius:30px;
  border:none;background:#ffd369;
  color:#000;cursor:pointer;
  opacity:.5
}
#playBtn.ready{opacity:1}
#lineBox{
  position:absolute;bottom:12%;
  width:90%;text-align:center
}
.line{opacity:.3;font-size:18px;margin:6px 0}
.line.active{opacity:1;font-size:22px;color:#ffd369}
.word.active{
  background:rgba(255,211,105,.4);
  padding:2px 4px;border-radius:4px
}
</style>
</head>

<body>
<div class="container">
  <button id="playBtn">▶️ सुनें</button>
  <div id="lineBox"></div>
</div>

<audio id="flute" src="flute.mp3" loop></audio>

<script>
/* ================= CONTENT ================= */
const lines=[
"शांत मन में ही सच्चा ज्ञान उतरता है",
"शब्द नहीं भावना परिवर्तन लाती है",
"जो स्वयं को समझ ले वही जगत को समझता है",
"विचार बीज हैं कर्म उनका वृक्ष",
"अहंकार ज्ञान का सबसे बड़ा शत्रु है"
];

/* ================= SETUP ================= */
const box=document.getElementById("lineBox");
const btn=document.getElementById("playBtn");
const flute=document.getElementById("flute");
flute.volume=0.18;

lines.forEach((t,i)=>{
  const d=document.createElement("div");
  d.className="line";d.id="l"+i;
  t.split(" ").forEach(w=>{
    const s=document.createElement("span");
    s.textContent=w+" ";d.appendChild(s)
  });
  box.appendChild(d)
});

/* ================= VOICE LOADER ================= */
let femaleVoice=null;

function loadVoices(){
  const v=speechSynthesis.getVoices();
  femaleVoice=v.find(x=>x.lang==="hi-IN")||v[0];
  if(femaleVoice){
    btn.classList.add("ready");
  }
}
speechSynthesis.onvoiceschanged=loadVoices;
loadVoices();

/* ================= SPEAK ================= */
function speakLine(i){
  if(i>=lines.length){flute.pause();return}

  document.querySelectorAll(".line").forEach(l=>l.classList.remove("active"));
  const line=document.getElementById("l"+i);
  line.classList.add("active");

  const words=line.querySelectorAll("span");
  let wi=0;

  const u=new SpeechSynthesisUtterance(lines[i]);
  u.lang="hi-IN";
  u.rate=0.9;
  u.pitch=1.1;
  if(femaleVoice)u.voice=femaleVoice;

  u.onboundary=e=>{
    if(e.name==="word" && words[wi]){
      words.forEach(w=>w.classList.remove("active"));
      words[wi].classList.add("active");
      wi++;
    }
  };
  u.onend=()=>setTimeout(()=>speakLine(i+1),800);

  speechSynthesis.speak(u);
}

/* ================= BUTTON ================= */
btn.onclick=()=>{
  if(!btn.classList.contains("ready")){
    alert("आवाज़ लोड हो रही है… एक सेकंड रुकिए");
    return;
  }
  speechSynthesis.cancel();
  flute.currentTime=0;
  flute.play();
  speakLine(0);
};
</script>
</body>
</html>
